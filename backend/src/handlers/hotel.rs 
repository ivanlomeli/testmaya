// backend/src/handlers/hotel.rs
use sqlx::PgPool;
use crate::models::UserInfo;

pub async fn verify_hotel_ownership(pool: &PgPool, hotel_id: i32, user: &UserInfo) -> Result<bool, sqlx::Error> {
    // Si es admin, puede acceder a todo
    if user.user_type == "admin" {
        return Ok(true);
    }
    
    // Verificar si el usuario es dueÃ±o del hotel
    let result = sqlx::query!(
        "SELECT owner_id FROM hotels WHERE id = $1",
        hotel_id
    )
    .fetch_optional(pool)
    .await?;
    
    match result {
        Some(hotel) => Ok(hotel.owner_id == Some(user.id)),
        None => Ok(false), // Hotel no existe
    }
}